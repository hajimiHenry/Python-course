# Day10：常用数据结构之元组（tuple）——“封口袋”式的序列

> 对照教程：`Python-100-Days/Day01-20/10.常用数据结构之元组.md`

## 0. 开场：为什么要学元组？

前面我们学了 **list（列表）**：它像“购物车”，可以随时增删改元素，适合做批量数据处理。  
但 Python 里还有另一类很常见的容器：**tuple（元组）**。

你可以把元组理解成“**封口袋 + 清单**”：袋子一旦封好，里面放了什么、顺序是什么，就不允许你再改动（**不可变**）。

---

## 1. 元组的定义和运算

### 1.1 元组是什么？

在 Python 中，元组也是“多个元素按一定顺序构成的序列”。它和列表最核心的区别是：

- **元组是不可变类型（immutable）**
  - 一旦定义：不能添加元素、不能删除元素、也不能修改元素的值
  - 如果试图修改元组中的元素，会引发 `TypeError`

元组常用字面量写法是：`(x, y, z)`。

---

### 1.2 看一遍：元组支持哪些常见运算？

> 元组支持的很多运算符，和列表是一样的（索引、切片、遍历、成员运算、拼接、比较等）。

```python
# 定义一个三元组
t1 = (35, 12, 98)
# 定义一个四元组
t2 = ('骆昊', 45, True, '四川成都')

# 查看变量的类型
print(type(t1))  # <class 'tuple'>
print(type(t2))  # <class 'tuple'>

# 查看元组中元素的数量
print(len(t1))  # 3
print(len(t2))  # 4

# 索引运算
print(t1[0])    # 35
print(t1[2])    # 98
print(t2[-1])   # 四川成都

# 切片运算
print(t2[:2])   # ('骆昊', 45)
print(t2[::3])  # ('骆昊', '四川成都')

# 循环遍历元组中的元素
for elem in t1:
    print(elem)

# 成员运算
print(12 in t1)         # True
print(99 in t1)         # False
print('Hao' not in t2)  # True

# 拼接运算
t3 = t1 + t2
print(t3)  # (35, 12, 98, '骆昊', 45, True, '四川成都')

# 比较运算
print(t1 == t3)            # False
print(t1 >= t3)            # False
print(t1 <= (35, 11, 99))  # False
```

补充两个小概念：

- 元组里有 **2 个元素**：叫 **二元组**
- 元组里有 **5 个元素**：叫 **五元组**（以此类推）

---

### 1.3 空元组 / 一元组（最容易踩坑的点）

- `()` 表示 **空元组**
- 元组只有 **1 个元素** 时，必须加逗号：`('hello',)`、`(100,)`
  - 否则 `()` 会被当成“改变运算优先级的圆括号”，不是元组字面量

用代码验证一下：

```python
a = ()
print(type(a))  # <class 'tuple'>
b = ('hello')
print(type(b))  # <class 'str'>
c = (100)
print(type(c))  # <class 'int'>
d = ('hello', )
print(type(d))  # <class 'tuple'>
e = (100, )
print(type(e))  # <class 'tuple'>
```

---

## 2. 打包和解包操作

这一部分非常重要：写 Python 时经常会用到。

### 2.1 打包（packing）

当我们把多个用逗号分隔的值赋给一个变量时，多个值会“打包”成一个元组：

```python
# 打包操作
a = 1, 10, 100
print(type(a))  # <class 'tuple'>
print(a)        # (1, 10, 100)
```

### 2.2 解包（unpacking）

当我们把一个元组赋值给多个变量时，元组会“解包”成多个值，分别赋给对应变量：

```python
# 解包操作
i, j, k = a
print(i, j, k)  # 1 10 100
```

如果解包出来的元素个数和变量个数不对应，会引发 `ValueError`：

- `too many values to unpack`：值太多
- `not enough values to unpack`：值不够

```python
a = 1, 10, 100, 1000
# i, j, k = a             # ValueError: too many values to unpack (expected 3)
# i, j, k, l, m, n = a    # ValueError: not enough values to unpack (expected 6, got 4)
```

### 2.3 星号表达式（`*`）：让一个变量“接住多个值”

当“元素个数 > 变量个数”时，可以用星号表达式解决：

- 用 `*` 修饰的变量会变成一个 **list**
- 在解包语法中，星号表达式只能出现 **一次**

```python
a = 1, 10, 100, 1000
i, j, *k = a
print(i, j, k)        # 1 10 [100, 1000]
i, *j, k = a
print(i, j, k)        # 1 [10, 100] 1000
*i, j, k = a
print(i, j, k)        # [1, 10] 100 1000
*i, j = a
print(i, j)           # [1, 10, 100] 1000
i, *j = a
print(i, j)           # 1 [10, 100, 1000]
i, j, k, *l = a
print(i, j, k, l)     # 1 10 100 [1000]
i, j, k, l, *m = a
print(i, j, k, l, m)  # 1 10 100 1000 []
```

### 2.4 解包语法对所有序列都成立

不仅元组可以解包：列表、`range()` 产生的序列，甚至字符串都可以。

```python
a, b, *c = range(1, 10)
print(a, b, c)
a, b, c = [1, 10, 100]
print(a, b, c)
a, *b, c = 'hello'
print(a, b, c)
```

---

## 3. 交换变量的值

很多编程语言交换两个变量的值，需要借助一个中间变量；Python 可以直接一行：

```python
a, b = b, a
```

三个变量互换也可以：

```python
a, b, c = b, c, a
```

> 说明：上面的操作并没有用到“打包和解包”的语法；Python 的字节码指令中有 `ROT_TWO` 和 `ROT_THREE` 可以直接完成交换，效率很高。  
> 但如果要依次互换的变量多于 3 个，就没有直接可用的字节码指令了，需要通过打包/解包来完成。

---

## 4. 元组和列表的比较

一个很值得思考的问题：

> Python 已经有列表了，为什么还需要元组？

先给出两个观点（初学时先记住结论，后面学并发/性能时会更有体感）：

1. 元组是不可变类型，**不可变类型更适合多线程环境**，因为它降低了并发访问变量的同步化开销。
2. 元组是不可变类型，通常**不可变类型在创建时间上优于对应的可变类型**。

### 4.1 用 `timeit` 看看创建速度差异

`timeit.timeit` 的 `number` 表示执行次数。下面分别创建保存 `1~9` 的列表和元组，各执行 `10000000` 次：

```python
import timeit

print('%.3f 秒' % timeit.timeit('[1, 2, 3, 4, 5, 6, 7, 8, 9]', number=10000000))
print('%.3f 秒' % timeit.timeit('(1, 2, 3, 4, 5, 6, 7, 8, 9)', number=10000000))
```

输出示例：

```
0.635 秒
0.078 秒
```

> 说明：执行结果因软硬件系统而异。在教程作者的电脑上，创建元组明显更快，而且二者有数量级差别。你也可以在自己的电脑上跑一遍，看看结果。

### 4.2 元组与列表可以相互转换

```python
infos = ('骆昊', 43, True, '四川成都')
# 将元组转换成列表
print(list(infos))  # ['骆昊', 43, True, '四川成都']

frts = ['apple', 'banana', 'orange']
# 将列表转换成元组
print(tuple(frts))  # ('apple', 'banana', 'orange')
```

---

## 5. 总结（把主线再捋一遍）

- **列表和元组都是容器型数据类型**：一个变量可以保存多个数据，且都是“有序容器”
- **列表是可变数据类型**：能增删改、清空、排序、反转……
- **元组是不可变数据类型**：不能增删改元素（否则会报错）
- 列表和元组都支持：**拼接 / 成员 / 索引 / 切片** 等操作
  - 后面会学到的 **字符串** 也支持这些操作，因为字符串本质上也是“字符序列”
- 教程还提醒：创建列表时，推荐使用 **列表生成式**，好用且效率高（后续章节会系统讲）


# Day11：字符串（str）完整讲义

> 每个方法都会讲清楚：**用处 → 语法 → 示例 → 注意事项**

---

## 0. 字符串是什么

字符串就是**一串文字**，比如 `"hello"`、`"你好"`、`"abc123"`。

在 Python 里，字符串用**引号**包起来：
```python
s1 = 'hello'       # 单引号
s2 = "world"       # 双引号
s3 = '''多行
文本'''             # 三引号（可以换行）
```

### 🔴 核心特性：字符串是不可变的

```python
s = "hello"
s[0] = "H"  # ❌ 报错！TypeError: 'str' object does not support item assignment
```

你**不能直接修改**字符串的某个字符，只能创建一个新字符串。

---

## 1. 基础运算

### 1.1 `len()` — 获取长度

| 项目 | 内容 |
|------|------|
| **用处** | 统计字符串有多少个字符 |
| **语法** | `len(字符串)` |
| **返回值** | 整数（字符个数） |

```python
s = "hello"
print(len(s))  # 5

s2 = "你好"
print(len(s2))  # 2（中文也是 1 个字符算 1 个）
```

---

### 1.2 `+` — 拼接字符串

| 项目 | 内容 |
|------|------|
| **用处** | 把两个字符串连起来 |
| **语法** | `字符串1 + 字符串2` |
| **返回值** | 新字符串 |

```python
s1 = "hello"
s2 = "world"
s3 = s1 + ", " + s2
print(s3)  # hello, world
```

---

### 1.3 `*` — 重复字符串

| 项目 | 内容 |
|------|------|
| **用处** | 把字符串重复 N 次 |
| **语法** | `字符串 * 次数` |
| **返回值** | 新字符串 |

```python
s = "ha"
print(s * 3)  # hahaha

print("-" * 20)  # --------------------（常用于分隔线）
```

---

### 1.4 `in` / `not in` — 成员判断

| 项目 | 内容 |
|------|------|
| **用处** | 判断一个字符串是否包含另一个字符串 |
| **语法** | `子串 in 字符串` 或 `子串 not in 字符串` |
| **返回值** | `True` 或 `False` |

```python
s = "hello, world"

print("world" in s)      # True
print("python" in s)     # False
print("python" not in s) # True
```

**⚠️ 注意**：这是判断"有没有"最推荐的写法，比 `find()` 更 Pythonic。

---

### 1.5 索引 `[]` — 取单个字符

| 项目 | 内容 |
|------|------|
| **用处** | 取出字符串中某个位置的字符 |
| **语法** | `字符串[索引]` |
| **返回值** | 单个字符（字符串类型） |

```python
s = "hello"

# 正向索引（从 0 开始）
print(s[0])  # h
print(s[1])  # e
print(s[4])  # o

# 负向索引（从 -1 开始，表示倒数第几个）
print(s[-1])  # o（最后一个）
print(s[-2])  # l（倒数第二个）
```

**⚠️ 注意**：索引越界会报错 `IndexError`
```python
print(s[10])  # ❌ IndexError: string index out of range
```

---

### 1.6 切片 `[start:end:step]` — 取一段字符

| 项目 | 内容 |
|------|------|
| **用处** | 取出字符串中一段连续的字符 |
| **语法** | `字符串[开始:结束:步长]` |
| **返回值** | 新字符串 |

**🔑 口诀**：**左闭右开**（包含开始位置，不包含结束位置）

```python
s = "hello, world"
#    0123456789...

print(s[0:5])   # hello（取索引 0~4）
print(s[7:12])  # world（取索引 7~11）
print(s[:5])    # hello（省略开始 = 从头开始）
print(s[7:])    # world（省略结束 = 到末尾结束）
print(s[::2])   # hlo ol（每隔 1 个取 1 个）
print(s[::-1])  # dlrow ,olleh（倒序）
```

**常用技巧**：
```python
s[::-1]  # 字符串反转
s[:]     # 复制整个字符串
```

---

## 2. 查找方法

### 2.1 `find()` — 查找子串位置（找不到返回 -1）

| 项目 | 内容 |
|------|------|
| **用处** | 查找子串第一次出现的位置 |
| **语法** | `字符串.find(子串)` 或 `字符串.find(子串, 开始位置)` |
| **返回值** | 找到返回索引（整数），找不到返回 **-1** |

```python
s = "hello, world"

print(s.find("or"))    # 8（"or" 从索引 8 开始）
print(s.find("python")) # -1（找不到）
print(s.find("o"))     # 4（第一个 "o" 的位置）
print(s.find("o", 5))  # 8（从索引 5 开始找，找到第二个 "o"）
```

**✅ 推荐**：初学时优先用 `find()`，因为找不到不会报错。

---

### 2.2 `rfind()` — 从右边开始查找

| 项目 | 内容 |
|------|------|
| **用处** | 查找子串**最后一次**出现的位置 |
| **语法** | `字符串.rfind(子串)` |
| **返回值** | 找到返回索引，找不到返回 **-1** |

```python
s = "hello, world"

print(s.find("o"))   # 4（第一个 o）
print(s.rfind("o"))  # 8（最后一个 o）
```

---

### 2.3 `index()` — 查找子串位置（找不到报错）

| 项目 | 内容 |
|------|------|
| **用处** | 查找子串第一次出现的位置 |
| **语法** | `字符串.index(子串)` |
| **返回值** | 找到返回索引，找不到**抛出 ValueError** |

```python
s = "hello, world"

print(s.index("or"))  # 8
print(s.index("xx"))  # ❌ ValueError: substring not found
```

**⚠️ 对比 find() 和 index()**：

| 方法 | 找不到时 |
|------|----------|
| `find()` | 返回 `-1` |
| `index()` | **报错** `ValueError` |

---

### 2.4 `count()` — 统计子串出现次数

| 项目 | 内容 |
|------|------|
| **用处** | 统计子串在字符串中出现了多少次 |
| **语法** | `字符串.count(子串)` |
| **返回值** | 整数 |

```python
s = "hello, world"

print(s.count("o"))   # 2
print(s.count("ll"))  # 1
print(s.count("x"))   # 0
```

---

### 2.5 `startswith()` / `endswith()` — 判断开头/结尾

| 项目 | 内容 |
|------|------|
| **用处** | 判断字符串是否以某个子串开头/结尾 |
| **语法** | `字符串.startswith(子串)` / `字符串.endswith(子串)` |
| **返回值** | `True` 或 `False` |

```python
s = "hello, world"

print(s.startswith("hello"))  # True
print(s.startswith("Hello"))  # False（区分大小写！）
print(s.endswith("world"))    # True
print(s.endswith("!"))        # False
```

---

## 3. 替换和修改

### 3.1 `replace()` — 替换子串

| 项目 | 内容 |
|------|------|
| **用处** | 把字符串中的某个子串替换成另一个 |
| **语法** | `字符串.replace(旧子串, 新子串)` 或 `字符串.replace(旧子串, 新子串, 次数)` |
| **返回值** | 新字符串（原字符串不变！） |

```python
s = "hello, world"

new_s = s.replace("world", "python")
print(s)      # hello, world（原字符串不变）
print(new_s)  # hello, python

# 替换所有
s2 = "aaa"
print(s2.replace("a", "b"))     # bbb

# 只替换前 N 次
print(s2.replace("a", "b", 2))  # bba
```

**⚠️ 重点**：`replace()` 不会修改原字符串，而是返回一个新字符串！

---

### 3.2 `strip()` / `lstrip()` / `rstrip()` — 去除两端字符

| 项目 | 内容 |
|------|------|
| **用处** | 去除字符串两端的空白字符（或指定字符） |
| **语法** | `字符串.strip()` / `字符串.lstrip()` / `字符串.rstrip()` |
| **返回值** | 新字符串 |

```python
s = "  hello, world  "

print(f"|{s.strip()}|")   # |hello, world|（去掉两边空格）
print(f"|{s.lstrip()}|")  # |hello, world  |（只去左边）
print(f"|{s.rstrip()}|")  # |  hello, world|（只去右边）
```

**指定要去除的字符**：
```python
s = "###hello###"

print(s.strip("#"))   # hello
print(s.lstrip("#"))  # hello###
print(s.rstrip("#"))  # ###hello
```

**🔑 口诀**：
- `strip` = 两边都去
- `lstrip` = 只去 left（左边）
- `rstrip` = 只去 right（右边）

---

## 4. 大小写转换

### 4.1 `upper()` — 全部转大写

```python
s = "Hello World"
print(s.upper())  # HELLO WORLD
```

### 4.2 `lower()` — 全部转小写

```python
s = "Hello World"
print(s.lower())  # hello world
```

### 4.3 `title()` — 每个单词首字母大写

```python
s = "hello world"
print(s.title())  # Hello World
```

### 4.4 `capitalize()` — 首字母大写，其余小写

```python
s = "hello WORLD"
print(s.capitalize())  # Hello world
```

### 4.5 `swapcase()` — 大小写互换

```python
s = "Hello World"
print(s.swapcase())  # hELLO wORLD
```

---

## 5. 拆分和合并

### 5.1 `split()` — 拆分成列表

| 项目 | 内容 |
|------|------|
| **用处** | 按指定分隔符把字符串拆成列表 |
| **语法** | `字符串.split(分隔符)` 或 `字符串.split(分隔符, 最大拆分次数)` |
| **返回值** | 列表 |

```python
s = "I love python"

# 默认按空白字符拆分
print(s.split())  # ['I', 'love', 'python']

# 按指定字符拆分
s2 = "a#b#c#d"
print(s2.split("#"))  # ['a', 'b', 'c', 'd']

# 限制拆分次数
print(s2.split("#", 2))  # ['a', 'b', 'c#d']（只拆 2 次）
```

**⚠️ 注意：连续分隔符会产生空字符串**
```python
s = "a##b"
print(s.split("#"))  # ['a', '', 'b']  ← 注意中间有个空字符串！
```

---

### 5.2 `join()` — 把列表合并成字符串

| 项目 | 内容 |
|------|------|
| **用处** | 用指定连接符把列表中的元素连成字符串 |
| **语法** | `连接符.join(列表)` |
| **返回值** | 字符串 |

```python
words = ['I', 'love', 'python']

print(" ".join(words))   # I love python
print("-".join(words))   # I-love-python
print("".join(words))    # Ilovepython（无缝拼接）
```

**🔑 记忆技巧**：谁调用 `.join()`，谁就是连接符
- `"-".join(words)` → 用 `-` 连接
- `" ".join(words)` → 用空格连接

---

### 5.3 `split()` 和 `join()` 是一对

```python
# split：字符串 → 列表
s = "a-b-c"
parts = s.split("-")
print(parts)  # ['a', 'b', 'c']

# join：列表 → 字符串
new_s = "#".join(parts)
print(new_s)  # a#b#c
```

---

## 6. 判断方法（返回 True/False）

| 方法 | 用处 | 示例 |
|------|------|------|
| `isdigit()` | 是否全是数字 | `"123".isdigit()` → `True` |
| `isalpha()` | 是否全是字母 | `"abc".isalpha()` → `True` |
| `isalnum()` | 是否全是字母或数字 | `"abc123".isalnum()` → `True` |
| `isspace()` | 是否全是空白字符 | `"   ".isspace()` → `True` |
| `isupper()` | 是否全是大写 | `"ABC".isupper()` → `True` |
| `islower()` | 是否全是小写 | `"abc".islower()` → `True` |

```python
s = "abc123"

print(s.isdigit())  # False（不是全数字）
print(s.isalpha())  # False（不是全字母）
print(s.isalnum())  # True（全是字母+数字）
```

---

## 7. 格式化输出

### 7.1 f-string（推荐！）

| 项目 | 内容 |
|------|------|
| **用处** | 把变量值嵌入字符串中 |
| **语法** | `f"文本 {变量} 文本"` |

```python
name = "小明"
age = 18
score = 95.678

# 基本用法
print(f"我是 {name}，今年 {age} 岁")  # 我是 小明，今年 18 岁

# 格式控制
print(f"成绩：{score:.2f}")     # 成绩：95.68（保留 2 位小数）
print(f"百分比：{0.856:.1%}")   # 百分比：85.6%
print(f"编号：{7:03d}")         # 编号：007（补零到 3 位）
```

### 7.2 常用格式控制

| 格式 | 作用 | 示例 |
|------|------|------|
| `{:.2f}` | 保留 2 位小数 | `f"{3.14159:.2f}"` → `3.14` |
| `{:.0f}` | 不要小数 | `f"{3.14:.0f}"` → `3` |
| `{:d}` | 整数 | `f"{42:d}"` → `42` |
| `{:03d}` | 整数补零到 3 位 | `f"{7:03d}"` → `007` |
| `{:.2%}` | 百分比 | `f"{0.25:.2%}"` → `25.00%` |
| `{:>10}` | 右对齐，总宽度 10 | `f"{'hi':>10}"` → `"        hi"` |
| `{:<10}` | 左对齐，总宽度 10 | `f"{'hi':<10}"` → `"hi        "` |
| `{:^10}` | 居中，总宽度 10 | `f"{'hi':^10}"` → `"    hi    "` |
| `{:,}` | 千分位分隔 | `f"{1000000:,}"` → `1,000,000` |

---

## 8. 对齐方法

### 8.1 `center()` — 居中对齐

```python
s = "hello"
print(s.center(11, "*"))  # ***hello***
```

### 8.2 `ljust()` — 左对齐

```python
s = "hello"
print(s.ljust(10, "-"))  # hello-----
```

### 8.3 `rjust()` — 右对齐

```python
s = "hello"
print(s.rjust(10, "-"))  # -----hello
```

### 8.4 `zfill()` — 左侧补零

```python
print("42".zfill(5))   # 00042
print("-42".zfill(5))  # -0042（负号会保留在最前面）
```

---

## 9. 编码与解码

### 9.1 `encode()` — 字符串 → 字节

```python
s = "你好"
b = s.encode("utf-8")
print(b)        # b'\xe4\xbd\xa0\xe5\xa5\xbd'
print(type(b))  # <class 'bytes'>
```

### 9.2 `decode()` — 字节 → 字符串

```python
b = b'\xe4\xbd\xa0\xe5\xa5\xbd'
s = b.decode("utf-8")
print(s)  # 你好
```

**⚠️ 注意**：编码和解码必须用**同一种编码格式**，否则会乱码或报错。

---

## 10. 转义字符

| 转义字符 | 含义 |
|----------|------|
| `\n` | 换行 |
| `\t` | 制表符（Tab） |
| `\\` | 反斜杠本身 |
| `\'` | 单引号 |
| `\"` | 双引号 |

```python
print("第一行\n第二行")
# 输出：
# 第一行
# 第二行

print("姓名\t年龄")
# 输出：姓名	年龄（中间是 Tab）
```

### 原始字符串 `r"..."`

如果不想让 `\` 转义，可以用原始字符串：

```python
print("C:\new\folder")    # C:（换行）ew（换行）older
print(r"C:\new\folder")   # C:\new\folder（原样输出）
```

---

## 11. 完整速查表

| 类别 | 方法 | 作用 |
|------|------|------|
| **长度** | `len(s)` | 获取长度 |
| **索引切片** | `s[i]`, `s[a:b]` | 取字符/取片段 |
| **拼接重复** | `+`, `*` | 拼接/重复 |
| **成员判断** | `in`, `not in` | 判断是否包含 |
| **查找** | `find()`, `rfind()` | 查找位置（找不到返回 -1） |
| **查找** | `index()`, `rindex()` | 查找位置（找不到报错） |
| **统计** | `count()` | 统计出现次数 |
| **判断开头结尾** | `startswith()`, `endswith()` | 判断开头/结尾 |
| **替换** | `replace()` | 替换子串 |
| **去空白** | `strip()`, `lstrip()`, `rstrip()` | 去两端字符 |
| **大小写** | `upper()`, `lower()`, `title()` | 大小写转换 |
| **拆分** | `split()` | 拆成列表 |
| **合并** | `join()` | 列表合成字符串 |
| **判断类型** | `isdigit()`, `isalpha()`, `isalnum()` | 判断字符类型 |
| **对齐** | `center()`, `ljust()`, `rjust()`, `zfill()` | 对齐填充 |
| **编码** | `encode()`, `decode()` | 编码/解码 |

---

## 12. 常见踩坑总结

| 坑 | 正确理解 |
|----|----------|
| `s.replace("a", "b")` 后 s 没变？ | `replace()` 返回新字符串，原字符串不变。要用 `s = s.replace(...)` |
| `s.split("#")` 后 s 没变？ | 同上，`split()` 返回新列表，原字符串不变 |
| `s[0] = "A"` 报错？ | 字符串不可变，不能通过索引修改 |
| `find()` 和 `index()` 分不清？ | `find` 找不到返回 -1，`index` 找不到报错 |
| 判断有没有子串用哪个？ | 推荐用 `if "子串" in s:`，更 Pythonic |
| `split` 出现空字符串？ | 连续分隔符会产生空字符串，如 `"a##b".split("#")` → `['a', '', 'b']` |

---

## 13. 练习时间

```python
s = "  Hello, Python World!  "
```

尝试完成以下操作（写完代码运行一下）：

1. 去掉两端空格
2. 全部转小写
3. 判断是否包含 "python"（忽略大小写）
4. 把 "World" 替换成 "Universe"
5. 按逗号拆分成列表
6. 用 " | " 把列表拼回字符串

**参考答案**：
```python
s = "  Hello, Python World!  "

# 1. 去掉两端空格
s1 = s.strip()
print(s1)  # Hello, Python World!

# 2. 全部转小写
s2 = s1.lower()
print(s2)  # hello, python world!

# 3. 判断是否包含 "python"（忽略大小写）
print("python" in s2)  # True

# 4. 把 "World" 替换成 "Universe"
s3 = s1.replace("World", "Universe")
print(s3)  # Hello, Python Universe!

# 5. 按逗号拆分成列表
parts = s1.split(",")
print(parts)  # ['Hello', ' Python World!']

# 6. 用 " | " 把列表拼回字符串
result = " | ".join(parts)
print(result)  # Hello |  Python World!
```

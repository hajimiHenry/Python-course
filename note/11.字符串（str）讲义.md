# Day11：常用数据结构之字符串（str）讲义

> 对照教程：`Python-100-Days/Day01-20/11.常用数据结构之字符串.md`

## 0. 这节课你要拿下什么

- 知道字符串 `str` 是什么，如何定义与表示特殊字符。
- 掌握字符串的核心运算：拼接、重复、比较、成员、长度、索引、切片。
- 熟练使用常见字符串方法：查找、判断、格式化、修剪、替换、拆分与合并。
- 理解 `str` 和 `bytes` 的关系，避免编码/解码错误。
- 建立“高效学习顺序”：先会读写，再会查改，最后会格式化与编码。

---

## 1. 为什么字符串很重要

现代计算机最早主要做数值计算（例如 ENIAC），但今天程序大量处理的是文本信息。  
要处理文本，就必须掌握字符串。

可以把字符串理解成“**字符组成的有序队列**”：  
每个字符都有位置（索引），可以读、可以切片，但**不能原地改某个字符**。

---

## 2. 字符串的定义

### 2.1 概念

字符串是由零个或多个字符组成的有限序列。  
Python 中用单引号、双引号、三引号都可以定义字符串。

```python
s1 = 'hello, world!'
s2 = "你好，世界！❤️"
s3 = '''hello,
wonderful
world!'''
print(s1)
print(s2)
print(s3)
```

### 2.2 转义字符（`\`）

反斜杠会让后面的字符“改义”：

- `\n`：换行
- `\t`：制表符
- `\r`：回车

如果字符串里要出现 `'`、`"`、`\` 本身，需要转义。

```python
s1 = '\'hello, world!\''
s2 = '\\hello, world!\\'
print(s1)
print(s2)
```

### 2.3 原始字符串（`r''`）

在原始字符串里，字符按字面意义处理，不做普通转义。

```python
s1 = '\it \is \time \to \read \now'
s2 = r'\it \is \time \to \read \now'
print(s1)
print(s2)
```

理解要点：

- `s1` 中会把 `\t`、`\r`、`\n` 识别为转义。
- `s2` 中会按普通字符输出 `\` 和后面的字母。

### 2.4 字符的特殊表示

可以用八进制、十六进制、Unicode 编码表示字符：

```python
s1 = '\141\142\143\x61\x62\x63'  # abcabc
s2 = '\u9a86\u660a'              # 骆昊
print(s1)
print(s2)
```

---

## 3. 字符串的运算

### 3.1 拼接和重复

```python
s1 = 'hello' + ', ' + 'world'
print(s1)    # hello, world
s2 = '!' * 3
print(s2)    # !!!
s1 += s2
print(s1)    # hello, world!!!
s1 *= 2
print(s1)    # hello, world!!!hello, world!!!
```

高频技巧：`'a' * 100` 比手写 100 个 `a` 更高效、更不容易错。

### 3.2 比较运算（按编码逐字符比）

字符串比较本质是按字符编码逐位比较。

```python
s1 = 'a whole new world'
s2 = 'hello world'
print(s1 == s2)             # False
print(s1 < s2)              # True
print(s1 == 'hello world')  # False
print(s2 == 'hello world')  # True
print(s2 != 'Hello world')  # True
s3 = '骆昊'
print(ord('骆'))            # 39558
print(ord('昊'))            # 26122
s4 = '王大锤'
print(ord('王'))            # 29579
print(ord('大'))            # 22823
print(ord('锤'))            # 38180
print(s3 >= s4)             # True
print(s3 != s4)             # True
```

### 3.3 成员运算

```python
s1 = 'hello, world'
s2 = 'goodbye, world'
print('wo' in s1)      # True
print('wo' not in s2)  # False
print(s2 in s1)        # False
```

### 3.4 获取长度

```python
s = 'hello, world'
print(len(s))                 # 12
print(len('goodbye, world'))  # 14
```

### 3.5 索引和切片

字符串和列表、元组一样支持索引和切片，但字符串不可变。

```python
s = 'abc123456'
n = len(s)
print(s[0], s[-n])    # a a
print(s[n-1], s[-1])  # 6 6
print(s[2], s[-7])    # c c
print(s[5], s[-4])    # 3 3
print(s[2:5])         # c12
print(s[-7:-4])       # c12
print(s[2:])          # c123456
print(s[:2])          # ab
print(s[::2])         # ac246
print(s[::-1])        # 654321cba
```

易错点：

- 索引越界会报 `IndexError: string index out of range`。
- 不能写 `s[0] = 'A'`，因为字符串不可变。

---

## 4. 字符串遍历

两种写法都常用：

```python
s = 'hello'
for i in range(len(s)):
    print(s[i])
```

```python
s = 'hello'
for elem in s:
    print(elem)
```

实战建议：

- 只拿字符时，用 `for elem in s` 更简洁。
- 需要下标时，用 `for i in range(len(s))`。

---

## 5. 字符串方法（高频）

## 5.1 大小写变换

```python
s1 = 'hello, world!'
print(s1.capitalize())  # Hello, world!
print(s1.title())       # Hello, World!
print(s1.upper())       # HELLO, WORLD!
s2 = 'GOODBYE'
print(s2.lower())       # goodbye
print(s1)               # hello, world!
print(s2)               # GOODBYE
```

要点：字符串方法通常返回新字符串，原字符串不变。

### 5.2 查找：`find/index/rfind/rindex`

```python
s = 'hello, world!'
print(s.find('or'))      # 8
print(s.find('or', 9))   # -1
print(s.find('of'))      # -1
print(s.index('or'))     # 8
# print(s.index('or', 9))  # ValueError: substring not found
```

```python
s = 'hello world!'
print(s.find('o'))       # 4
print(s.rfind('o'))      # 7
print(s.rindex('o'))     # 7
# print(s.rindex('o', 8))  # ValueError: substring not found
```

区别必须记住：

- `find` / `rfind`：找不到返回 `-1`
- `index` / `rindex`：找不到抛 `ValueError`

### 5.3 性质判断

```python
s1 = 'hello, world!'
print(s1.startswith('He'))   # False
print(s1.startswith('hel'))  # True
print(s1.endswith('!'))      # True
s2 = 'abc123456'
print(s2.isdigit())  # False
print(s2.isalpha())  # False
print(s2.isalnum())  # True
```

### 5.4 对齐和格式化

```python
s = 'hello, world'
print(s.center(20, '*'))  # ****hello, world****
print(s.rjust(20))        #         hello, world
print(s.ljust(20, '~'))   # hello, world~~~~~~~~
print('33'.zfill(5))      # 00033
print('-33'.zfill(5))     # -0033
```

三种常见格式化方案：

```python
a = 321
b = 123
print('%d * %d = %d' % (a, b, a * b))          # 旧式 %
print('{0} * {1} = {2}'.format(a, b, a * b))   # str.format
print(f'{a} * {b} = {a * b}')                  # f-string（推荐）
```

常用格式控制（f-string / format 通用）：

- `{:.2f}`：保留 2 位小数
- `{:+.2f}`：带正负号保留 2 位小数
- `{:0>10d}`：左侧补零到 10 位
- `{:<10d}` / `{:>10d}`：左/右对齐补空格
- `{:,}`：千分位分隔
- `{:.2%}`：百分比格式
- `{:.2e}`：科学计数法

### 5.5 修剪

```python
s1 = '   jackfrued@126.com  '
print(s1.strip())      # jackfrued@126.com
s2 = '~你好，世界~'
print(s2.lstrip('~'))  # 你好，世界~
print(s2.rstrip('~'))  # ~你好，世界
```

### 5.6 替换

```python
s = 'hello, good world'
print(s.replace('o', '@'))     # hell@, g@@d w@rld
print(s.replace('o', '@', 1))  # hell@, good world
```

### 5.7 拆分与合并

```python
s = 'I love you'
words = s.split()
print(words)            # ['I', 'love', 'you']
print('~'.join(words))  # I~love~you
```

```python
s = 'I#love#you#so#much'
words = s.split('#')
print(words)  # ['I', 'love', 'you', 'so', 'much']
words = s.split('#', 2)
print(words)  # ['I', 'love', 'you#so#much']
```

---

## 6. 编码与解码（`str` 和 `bytes`）

- `str`：文本（字符）
- `bytes`：二进制字节序列

编码：`str -> bytes`  
解码：`bytes -> str`

```python
a = '骆昊'
b = a.encode('utf-8')
c = a.encode('gbk')
print(b)                  # b'\xe9\xaa\x86\xe6\x98\x8a'
print(c)                  # b'\xc2\xe6\xea\xbb'
print(b.decode('utf-8'))  # 骆昊
print(c.decode('gbk'))    # 骆昊
```

警告：

- 编码和解码方式不一致，可能出现乱码或 `UnicodeDecodeError`。

---

## 7. 其他方法（预告）

字符串模式匹配（如用户名、邮箱格式校验）通常用正则表达式。  
Python 用标准库 `re` 模块支持正则，后续课程会展开。

---

## 8. 高频易错点清单

- 把 `find` 和 `index` 用混：一个返回 `-1`，一个抛异常。
- 以为字符串方法会改原值：实际上多数方法返回新字符串。
- 忘记字符串不可变：不能通过索引赋值。
- 编码解码不配套：`utf-8` 编码就要用 `utf-8` 解码。
- `split` 默认按空白拆分，不是总按逗号拆分。

---

## 9. 高效学习路径（建议照这个顺序刷）

1. 先熟练“读字符串”：`len`、索引、切片、遍历。  
2. 再掌握“查改字符串”：`find/index`、`replace`、`strip`、`split/join`。  
3. 再掌握“输出字符串”：`f-string` + 常见格式控制。  
4. 最后补“编码解码”：`encode/decode` 和异常场景。  

---

## 10. 总结

字符串是文本处理的核心数据类型。  
你要把它当成“不可变的有序字符序列”：能切、能查、能拼、能格式化、能编码。  
只要把这节课的运算符和高频方法吃透，后面处理日志、接口数据、用户输入时会明显更顺手。

